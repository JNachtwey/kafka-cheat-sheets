### advanced Kafka security recommendations for TLS connections ###

Date: Oktober 2017 </BR>
Without warranty!

**TLS version:**</BR>
Use only TLS 1.2.
<sup>based on source:


</sup>

**Secured ciphers recommendation:**
>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 </BR>
TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384</BR>
TLS_RSA_WITH_AES_256_CBC_SHA256</BR>
TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384</BR>
TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384</BR>
TLS_DHE_RSA_WITH_AES_256_CBC_SHA256</BR>
TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256</BR>
TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256</BR>
TLS_RSA_WITH_AES_128_CBC_SHA256</BR>
TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256</BR>
TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256</BR>
TLS_DHE_RSA_WITH_AES_128_CBC_SHA256</BR>
TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</BR>
TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</BR>
TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</BR>
TLS_RSA_WITH_AES_256_GCM_SHA384</BR>
TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384</BR>
TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384</BR>
TLS_DHE_RSA_WITH_AES_256_GCM_SHA384</BR>
TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</BR>
TLS_RSA_WITH_AES_128_GCM_SHA256</BR>
TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256</BR>
TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256</BR>
TLS_DHE_RSA_WITH_AES_128_GCM_SHA256</BR>

<sup>based on source:


</sup>

**Random implementation**

<sup>based on source:


</sup>

**server.properties**
>ssl.tls.version: TLSv1.2 </BR>
ssl.secure.random.implementation: NativePRNG </BR>
ssl.cipher.suites:TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384,TLS_RSA_WITH_AES_256_CBC_SHA256,TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384,TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384,TLS_DHE_RSA_WITH_AES_256_CBC_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256,TLS_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256,TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256,TLS_DHE_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_128_GCM_SHA256


<sup>source:
https://security.stackexchange.com/questions/120347/how-to-disable-weak-cipher-suits-in-java-application-server-for-ssl
https://crypto.stackexchange.com/questions/19985/can-dh-anon-really-be-exploited-by-an-attacker
https://security.stackexchange.com/questions/145855/how-to-enforce-perfect-forward-secrecy-using-jvm-properties
</sup>

**Remark**

The TLS version and cipher are also restrictable with java.security policy. The file is usually located under:

jre/lib/security/java.security. </BR>
Adjust the jdk.tls.disabledAlgorithms property. </BR> jre/lib/security/java.security. </BR>
Adjust the jdk.tls.disabledAlgorithms property.
